{# nourrir_flask/templates/politique.html #}
{% extends "base.html" %}

{% block title %}Politique d’intégration – NourrIR{% endblock %}

{% block content %}
<section class="p-6 my-8 rounded-lg shadow-md bg-base-200 prose max-w-none">

<!-- YouTube video embed -->
<div class="aspect-video my-6">
  <iframe
    src="https://www.youtube.com/embed/8c5-p9Ag6Qg"
    title="Vidéo de la politique d'intégration"
    class="w-full h-full"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen></iframe>
</div>

<div id="password-verification" class="text-center my-4">
  <label for="password-input" class="text-lg">Entrez le mot de passe pour télécharger :</label>
  <input id="password-input" type="password" class="mx-2 px-2 py-1 text-base border rounded" />
  <button id="password-submit" class="btn btn-primary">Valider</button>
  <div id="password-error" class="text-red-600 text-sm mt-2 hidden">Mot de passe incorrect.</div>
</div>
<div id="download-section" class="text-center my-4 hidden">
  <a id="download-link" href="{{ url_for('static', filename='assets/politique.pdf') }}" download class="text-lg">
    📄 Télécharger la politique d’intégration (PDF)
  </a>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const submitBtn = document.getElementById('password-submit');
  const passwordInput = document.getElementById('password-input');
  const errorDiv = document.getElementById('password-error');
  const downloadSection = document.getElementById('download-section');
  submitBtn.addEventListener('click', function() {
    if (passwordInput.value === 'REI1850') {
      errorDiv.style.display = 'none';
      downloadSection.style.display = 'block';
      passwordInput.disabled = true;
      submitBtn.disabled = true;
    } else {
      errorDiv.style.display = 'block';
    }
  });
});
</script>

<h1>Politique d’intégration des nouveaux employé·e·s</h1>

{# ———————————————————————————————————————————— #}
{# 1. INTRODUCTION #}
<h2>1. Introduction&nbsp;🎯</h2>
<p>
Cette politique vise à structurer le parcours d’accueil (<em>onboarding</em>) chez
<strong>NourrIR</strong> — une organisation qui place le bien-être mental, la nutrition consciente
et la créativité au cœur de sa mission&nbsp;💜🥕.  Elle s’adresse aux équipes RH, aux
gestionnaires ainsi qu’aux mentor·e·s afin d’assurer une intégration <em>humaine</em>,
<em>progressive</em> et <em>durable</em> des nouveaux talents.  L’intégration est reconnue comme
un moment critique de l’expérience employé puisqu’elle influence directement la
<b>satisfaction</b>, l’<b>engagement</b> et la <b>rétention</b>&nbsp;🚀 (Deloitte, 2017).
</p>

{# ———————————————————————————————————————————— #}
{# 2. NOTRE VISION DE L’INTÉGRATION #}
<h2>2. Notre vision de l’intégration&nbsp;👀</h2>
<p>Chez NourrIR, nous considérons qu’un bon départ est plus qu’un poste prêt et
un ordinateur fonctionnel.  Notre démarche est :</p>
<ul>
    <li>💡 <strong>Personnalisée</strong> : chaque personne apprend à son rythme ;</li>
    <li>📈 <strong>Progressive</strong> : jalons clés répartis sur les 12 premiers mois ;</li>
    <li>🤝 <strong>Interactive</strong> : feedback et co-construction continus ;</li>
    <li>🌐 <strong>Connectée</strong> : appuyée par la technologie et l’intelligence collective.</li>
</ul>
<p>Un <em>Portail d’accueil interactif</em> est disponible dès la signature de l’offre : il
contient des vidéos-capsules, un calendrier personnalisé et des micro-formations sur
nos valeurs afin de créer un lien précoce et durable.</p>

{# ———————————————————————————————————————————— #}
{# 3. RÔLES & RESPONSABILITÉS #}
<h2>3. Rôles et responsabilités&nbsp;🧑‍💼</h2>
<ul>
    <li><strong>Équipe RH&nbsp;🎯</strong> : coordonne le processus, prépare la trousse, gère le tableau de bord.</li>
    <li><strong>Gestionnaire&nbsp;👩‍💼</strong> : accueille, accompagne, anime les suivis à 3, 6 et 12 mois.</li>
    <li><strong>Pair d’intégration&nbsp;🤝</strong> : soutien informel, transmet la culture et facilite le réseau.</li>
    <li><strong>Nouvel·le employé·e&nbsp;🚀</strong> : participe activement, partage son feedback, co-construit son parcours.</li>
</ul>

{# ———————————————————————————————————————————— #}
{# 4. PARCOURS D'INTÉGRATION – TIMELINE #}
<h2>4. Parcours d’intégration&nbsp;🗺️</h2>

<style>
/* Simple timeline reused from the “Les Coulisses” aesthetic */
.timeline { position: relative; margin: 2em 0 2em 1.5em; }
.timeline::before { content: ""; position: absolute; left: 0; top: 0; width: 4px; height: 100%; background: var(--dopamine-purple); border-radius: 2px; }
.timeline-block { position: relative; margin-bottom: 2.2em; padding-left: 1.5em; }
.timeline-block::before { content: ""; position: absolute; left: -9px; top: 0.35em; width: 16px; height: 16px; background: var(--growth-green); border: 3px solid #fff; border-radius: 50%; box-shadow: 0 0 0 2px var(--dopamine-purple); }
.timeline-block h3 { margin-top: 0; }
</style>

<div class="timeline">
    <div class="timeline-block">
        <h3>✨ Avant l’entrée en poste (J-30 → J1)</h3>
        <ul>
            <li>Envoi d’un courriel de bienvenue personnalisé 📧 ;</li>
            <li>Accès au Portail d’accueil interactif (signature électronique, calendrier, micro-formations) 🖥️ ;</li>
            <li>Préparation de la trousse (équipement, accès logiciels, etc.) 🎁 ;</li>
            <li>Attribution du pair d’intégration et ajout aux canaux d’équipe 💬 ;</li>
            <li>Mini-sondage eNPS 48 h avant l’arrivée pour recueillir les attentes 📊.</li>
        </ul>
    </div>

    <div class="timeline-block">
        <h3>🚀 Première journée</h3>
        <ul>
            <li>Accueil par le gestionnaire et RH, visite des espaces & équipes 👋 ;</li>
            <li>Activation du Portail d’accueil : plan interactif & programme de la semaine 🗓️ ;</li>
            <li>Atelier express « Moments qui comptent » pour cartographier les 90 premiers jours 🗺️ ;</li>
            <li>Capsules vidéo sur la mission, la sécurité alimentaire & notre IA culinaire 🎥 ;</li>
            <li>Sondage éclair de fin de journée pour ajuster le lendemain 📝.</li>
        </ul>
    </div>

    <div class="timeline-block">
        <h3>📅 Suivi à 3 mois</h3>
        <ul>
            <li>Rencontre rétroaction 90 jours ;</li>
            <li>Atelier « Carrière & Apprentissage » ;</li>
            <li>Participation à un atelier inter-équipes pour étendre le réseau 🤗 ;</li>
            <li>Suivi de 3 KPI : eNPS 90, complétion d’apprentissage, Time-To-Productivity.</li>
        </ul>
    </div>

    <div class="timeline-block">
        <h3>⏳ Suivi à 6 mois</h3>
        <ul>
            <li>Table ronde 360° (gestionnaire, mentor, collègues, client interne) ;</li>
            <li>Dîner-causerie animé par la recrue 🍽️ ;</li>
            <li>Budget de 10 h de formation express sur notre plateforme interne 🎓 ;</li>
            <li>Indicateurs : réalisation 360°, utilisation budget, évolution eNPS 180.</li>
        </ul>
    </div>

    <div class="timeline-block">
        <h3>🎉 Suivi à 1 an</h3>
        <ul>
            <li>Atelier accéléré développement & mobilité interne ;</li>
            <li>Cérémonie « Moments qui comptent » 🏆 ;</li>
            <li>Invitation à un projet spécial (innovation, RSE, etc.) 🚀 ;</li>
            <li>Indicateurs : rétention 12 mois, eNPS annuel, participation projets transversaux.</li>
        </ul>
    </div>

    <div class="timeline-block">
        <h3>🔄 Évaluation continue</h3>
        <ul>
            <li>Tableau de bord temps réel alimenté par mini-sondages & données RH 📈 ;</li>
            <li>Enquête qualitative « Moments qui comptent » à 12 mois 🤔 ;</li>
            <li>Rétro-design trimestriel avec nouveaux employés & mentors 💬 ;</li>
            <li>Lien résultats ↔ actions : déclenchement automatique de modules de soutien ⚙️ .</li>
        </ul>
    </div>
</div>

{# ———————————————————————————————————————————— #}
{# 5. NOTE MÉTHODOLOGIQUE #}
<h2>5. Note méthodologique&nbsp;🧪</h2>
<p>
Cette politique a été rédigée et enrichie à l’aide d’<strong>outils d’intelligence artificielle</strong>
(principalement ChatGPT).  Les usages IA ont permis :
</p>
<ul>
    <li>🛠️ d’orchestrer et structurer l’information ;</li>
    <li>✍️ d’adapter le ton à une audience RH ;</li>
    <li>🔍 de valider la cohérence des références ;</li>
    <li>🎨 de générer des visuels et micro-contenus de formation.</li>
</ul>

{# ———————————————————————————————————————————— #}
{# 6. HISTORIQUE DES VERSIONS #}
<h2>6. Historique des versions&nbsp;📜</h2>
<table border="1" cellpadding="6" style="border-collapse:collapse;background:#fafafd;">
    <tr>
        <th>Version</th>
        <th>Date</th>
        <th>Modifications</th>
        <th>Auteur</th>
    </tr>
    <tr>
        <td>2.0</td>
        <td>24 mai 2025</td>
        <td>Mise à jour complète selon la nouvelle politique (Atelier 1)</td>
        <td>Équipe RH / ChatGPT</td>
    </tr>
    <tr>
        <td>1.0</td>
        <td>17 mai 2025</td>
        <td>Version initiale</td>
        <td>Talent & Culture / ChatGPT</td>
    </tr>
</table>



<!-- HTML for the "Ask NurrIA" popup -->
<div id="ask-nuria-popup" style="display: none; position: absolute; background-color: var(--dopamine-purple); color: white; padding: 8px 12px; border-radius: 20px; cursor: pointer; z-index: 1050; box-shadow: 0 2px 10px rgba(0,0,0,0.2); font-size: 0.9em; transition: opacity 0.2s, transform 0.2s;">
    Demander à NurrIA 💡
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const askNuriaPopup = document.getElementById('ask-nuria-popup');
    const policyContentArea = document.querySelector('main'); // Target the main content area
    let currentSelectedText = '';
    let popupIsVisible = false;

    if (!askNuriaPopup || !policyContentArea) {
        console.warn('Ask NurrIA feature: Required elements (popup or content area) not found.');
        return;
    }

    function showAskPopup(x, y) {
        // Adjust x to ensure popup doesn't go off-screen right, with a small buffer
        const maxX = window.innerWidth - askNuriaPopup.offsetWidth - 15;
        const finalX = Math.min(x, maxX);
        
        askNuriaPopup.style.left = finalX + 'px';
        askNuriaPopup.style.top = y + 'px';
        askNuriaPopup.style.display = 'block';
        askNuriaPopup.style.opacity = '1'; // For fade-in effect
        askNuriaPopup.style.transform = 'translateY(0)';
        popupIsVisible = true;
    }

    function hideAskPopup() {
        askNuriaPopup.style.opacity = '0';
        askNuriaPopup.style.transform = 'translateY(-5px)'; // Slight move up on hide
        setTimeout(() => {
            if (askNuriaPopup.style.opacity === '0') {
                askNuriaPopup.style.display = 'none';
            }
        }, 200); // Corresponds to transition duration
        popupIsVisible = false;
    }

    policyContentArea.addEventListener('mouseup', (event) => {
        // Do not proceed if the event target is the popup itself or inside it
        if (askNuriaPopup.contains(event.target)) {
            return;
        }

        const selection = window.getSelection();
        const selectedText = selection.toString().trim();

        if (selectedText.length > 0) {
            currentSelectedText = selectedText;
            const range = selection.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            
            let popupX = event.pageX + 5; 
            let popupY = event.pageY - askNuriaPopup.offsetHeight - 10; // Position above cursor

            // Boundary check: if popup would be above viewport, position below selection's bottom
            if ((window.scrollY + rect.top - askNuriaPopup.offsetHeight - 10) < window.scrollY) {
                 popupY = window.scrollY + rect.bottom + 10;
            }
            // Boundary check: if popup would be too far left (e.g., selection ends near left edge)
            if (event.clientX < (askNuriaPopup.offsetWidth / 2) + 10) { // 10px buffer
                popupX = event.pageX + 5; // Keep it to the right of cursor
            } 
            // Boundary check: if popup would be too far right
            else if (window.innerWidth - event.clientX < (askNuriaPopup.offsetWidth / 2) + 10) {
                popupX = event.pageX - askNuriaPopup.offsetWidth - 5; // To the left of cursor
            }


            showAskPopup(popupX, popupY);
        } else {
            // If no text is selected (e.g., just a click on policy content) and popup is visible, hide it.
            if (popupIsVisible && !askNuriaPopup.contains(event.target)) {
                 hideAskPopup();
            }
        }
    });

    askNuriaPopup.addEventListener('click', (event) => {
        event.stopPropagation(); // Prevent mousedown on document from hiding popup immediately

        if (currentSelectedText) {
            const chatBox = document.getElementById('nuria-chatbot-box'); 
            const chatToggle = document.getElementById('nuria-chatbot-toggle'); 
            const chatInput = document.getElementById('nuria-chat-input'); 

            if (chatBox && chatInput) { // chatToggle might be null if already hidden
                chatBox.style.display = 'flex';
                if (chatToggle) chatToggle.style.display = 'none'; // Hide toggle if visible
                
                chatInput.value = \`Peux-tu m'en dire plus sur : "${currentSelectedText}" ?\`;
                chatInput.focus(); 
            } else {
                console.warn('NurrIA chatbot elements not found in base.html for popup interaction.');
            }
        }
        hideAskPopup();
        currentSelectedText = ''; // Clear text after use
        // Clear browser selection
        if (window.getSelection) {
            if (window.getSelection().empty) { window.getSelection().empty(); } 
            else if (window.getSelection().removeAllRanges) { window.getSelection().removeAllRanges(); }
        } else if (document.selection) { document.selection.empty(); }
    });

    // General click listener to hide popup if clicking outside
    document.addEventListener('mousedown', (event) => {
        if (popupIsVisible && !askNuriaPopup.contains(event.target)) {
            // If a new selection is being made, mouseup on policyContent will handle it.
            // This primarily handles clicks completely outside the policy content or popup.
            const selection = window.getSelection();
            if (!selection || selection.toString().trim() === '') { // Only hide if no new selection is being made
                 hideAskPopup();
            }
        }
    });
});
    </script>

    <div class="presentation-container" style="text-align: center; margin: 2em 0;">
        <h2>Présentation interactive (Canva)</h2>
        <iframe src="https://www.canva.com/design/DAGn7T8JUpQ/view?embed" style="width:100%; height:600px; border:0;" allowfullscreen="allowfullscreen" loading="lazy"></iframe>
    </div>
</section>

{% endblock %}
